Working with Datawarehousing Solutions
========================================

Azure:
	- Azure Synapse Analytics (Serverless - Standalone)
				  (Server-based - SqlPool, SparkPool)					


AWS:
	- AWS Redshift (Server-based Arch)
	- AWS Athena	(Server-less Arch)




					Data warehousing Solutions
						|
			---------------------------------------------------------
			|							|
	Server-less Architecture					Server-based Architecture


					AWS Athena		
						|
		----------------------------------------------------------------------
		|				|				     |
	Storage part 		Processing Part			Metadata Management
	S3			Athena				AWS Glue




AWS Athena
===========

- Serverless Interactive Query Services for S3
- Deal with:
	a. Delimited Files
	b. XML
	c. JSON
	d. Parquet
	e. ORC
	f. Avro

- Athena requires two components:
	a. Data in S3
	b. Metadata in AWS Glue


AWS Glue
========

How to use Glue Data Catalog?

Glue Data Catalog is a component of AWS Glue that can store metadata (Schema Info)


https://docs.aws.amazon.com/athena/latest/ug/compression-formats.html
https://docs.aws.amazon.com/athena/latest/ug/create-table-as.html


create table autoresearch.stage1 with
(
  format='TEXTFILE',
  external_location='s3://dataset982378924/result/res1',
  field_delimiter = ','
) 
AS
select * from automobile limit 3;



Using AWS Glue to create schema using Crawler
==============================================

Using Glue Crawler
===================
Automobile Dataset----> S3 ------> AWS Glue


1. Create S3 bucket and load data in it
2. Go to Glue Dashboard > Crawler > Add Crawler. Follow the instructions and connect with the data source at folder level and Run the Crawler.




Using Manual Method
======================
employee ----> S3 ------>AWS Glue ------> Athena


1. Create S3 bucket and load data in it
2. Create Metadata for automobile dataset in Glue
	- Go to Glue Dashboard
	- On left hand menu click Databases > Add database > Create database named           'tigeranalytics'
	- Click on Tables > Add Table > Add Table Manually 
		- Give table name as 'employee' and select database 'tigeranalytics' > Next
		- Select Data Store > S3 > Set the Location of dataset > Next
		- Choose Data Format > CSV > Delimiter as , > Next
		- Create Schema with appropriate datatypes > Next
		- Skip Partition Indices as we didnt set any partition key > Next
		- Review the settings > Finish
		

3. Create Athena Instance and connect with metadata for Interactive Query
	- Go to Athena Dashboard and Click on Get Started

 Athena will automatically interact with Glue for Catalog and help provide platform for Interactive Query !






AWS Glue + Athena Assignment
=============================


txnsSmall

Perform both methods (Using Crawler and Using Manual Method in Glue)

Perform the following tasks and store the output in S3 Location (Athena)
1. Find the total revenue generated based on category
2. Find the total number of transactions done by credit and cash
3. Find the total amount generated by credit 
4. Find the highest selling category
5. Find the lowest selling category








